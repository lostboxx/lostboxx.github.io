<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="robots" content="noindex, nofollow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON ↔ YAML Конвертер</title>
    <script src="tools_help/j1.js"></script>
    <style>
        *{box-sizing:border-box;margin:0;padding:0;}
        body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:#fff;min-height:100vh;padding:20px;color:#333;}
        .container{max-width:1200px;margin:0 auto;background:white;box-shadow:0 10px 30px rgba(0,0,0,0.2);overflow:hidden;}
        .header{background:linear-gradient(135deg,#2c3e50,#34495e);color:white;padding:25px;text-align:center;}
        .header h1{font-size:2.2em;margin-bottom:10px;font-weight:300;}
        .header p{opacity:0.9;font-size:1.1em;}
        .file-upload{margin:15px 25px 0;display:flex;align-items:center;gap:10px;}
        .file-input{display:none;}
        .file-label{padding:8px 15px;background:#3498db;color:white;cursor:pointer;font-size:0.9em;}
        .file-label:hover{background:#2980b9;}
        .file-info{font-size:0.8em;color:#7f8c8d;}
        .converter-container{display:grid;grid-template-columns:1fr auto 1fr;gap:20px;padding:25px;align-items:start;}
        .input-section,.output-section{display:flex;flex-direction:column;height:500px;}
        .section-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;padding:0 5px;}
        .section-title{font-size:1.2em;font-weight:600;color:#2c3e50;}
        .language-badge{background:#3498db;color:white;padding:4px 12px;font-size:0.9em;font-weight:500;}
        .language-badge.json{background:#f39c12;}
        .language-badge.yaml{background:#27ae60;}
        textarea{flex:1;padding:15px;border:2px solid #e0e0e0;font-family:'Consolas','Monaco',monospace;font-size:14px;line-height:1.5;resize:none;transition:border-color 0.3s;}
        textarea:focus{outline:none;border-color:#3498db;}
        .input-area textarea{background:#f8f9fa;}
        .output-area textarea{background:#f0f7ff;}
        .controls{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:20px;padding:20px 0;}
        .convert-btn{background:green;color:white;border:none;padding:12px 25px;font-size:1.1em;font-weight:600;cursor:pointer;transition:all 0.3s;box-shadow:0 4px 15px rgba(52,152,219,0.3);display:flex;align-items:center;gap:8px;}
        .convert-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(52,152,219,0.4);}
        .convert-btn:active{transform:translateY(0);}
        .swap-btn{background:blue;color:white;border:none;width:45px;height:45px;font-size:1.2em;cursor:pointer;transition:all 0.3s;box-shadow:0 4px 10px rgba(155,89,182,0.3);}
        .swap-btn:hover{transform:rotate(180deg);background:green;}
        .action-buttons{display:flex;gap:15px;margin-top:20px;padding:0 25px 25px;justify-content:center;}
        .action-btn{padding:10px 20px;border:none;border-radius:8px;font-size:0.95em;font-weight:500;cursor:pointer;transition:all 0.3s;}
        .clear-btn{background:#e74c3c;color:white;}
        .clear-btn:hover{background:#c0392b;}
        .copy-btn{background:#2ecc71;color:white;}
        .copy-btn:hover{background:#27ae60;}
        .example-btn{background:#f39c12;color:white;}
        .example-btn:hover{background:#d35400;}
        .error-message{background:#e74c3c;color:white;padding:12px;border-radius:8px;margin:15px 25px;display:none;}
        .success-message{background:#2ecc71;color:white;padding:12px;border-radius:8px;margin:15px 25px;display:none;}
        @media (max-width:768px){.converter-container{grid-template-columns:1fr;grid-template-rows:auto auto auto;}.controls{flex-direction:row;justify-content:space-around;padding:10px 0;}}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>JSON ↔ YAML Конвертер</h1>
            <p>Взаимное преобразование между JSON и YAML форматами</p>
        </div>
        
        <div class="file-upload">
            <input type="file" id="file-input" class="file-input" accept=".json,.jso,.jsn,.yaml,.yml,.txt">
            <label for="file-input" class="file-label">Загрузить файл</label>
            <div id="file-info" class="file-info"></div>
        </div>
        
        <div class="converter-container">
            <div class="input-section">
                <div class="section-header">
                    <div class="section-title">Исходные данные</div>
                    <div class="language-badge" id="input-badge">JSON</div>
                </div>
                <textarea id="input-text" placeholder="Введите JSON или YAML данные..."></textarea>
            </div>
            
            <div class="controls">
                <button class="convert-btn" id="convert-btn">
                    <span>Конвертировать</span>
                    <span>→</span>
                </button>
                <button class="swap-btn" id="swap-btn" title="Поменять направление">⇄</button>
            </div>
            
            <div class="output-section">
                <div class="section-header">
                    <div class="section-title">Результат</div>
                    <div class="language-badge" id="output-badge">YAML</div>
                </div>
                <textarea id="output-text" readonly placeholder="Результат конвертации..."></textarea>
            </div>
        </div>
        
        <div class="error-message" id="error-message"></div>
        <div class="success-message" id="success-message"></div>
        
        <div class="action-buttons">
            <button class="action-btn example-btn" id="example-btn">Пример данных</button>
            <button class="action-btn clear-btn" id="clear-btn">Очистить всё</button>
            <button class="action-btn copy-btn" id="copy-btn">Копировать результат</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded',function(){
            const inputText=document.getElementById('input-text');
            const outputText=document.getElementById('output-text');
            const convertBtn=document.getElementById('convert-btn');
            const swapBtn=document.getElementById('swap-btn');
            const clearBtn=document.getElementById('clear-btn');
            const copyBtn=document.getElementById('copy-btn');
            const exampleBtn=document.getElementById('example-btn');
            const inputBadge=document.getElementById('input-badge');
            const outputBadge=document.getElementById('output-badge');
            const errorMessage=document.getElementById('error-message');
            const successMessage=document.getElementById('success-message');
            const fileInput=document.getElementById('file-input');
            const fileInfo=document.getElementById('file-info');
            
            let conversionDirection='json-to-yaml';
            
            function showMessage(element,text){
                element.textContent=text;
                element.style.display='block';
                setTimeout(()=>{element.style.display='none';},4000);
            }
            
            function handleFileUpload(file){
                const reader=new FileReader();
                reader.onload=function(e){
                    const content=e.target.result;
                    inputText.value=content;
                    const extension=file.name.split('.').pop().toLowerCase();
                    if(['json','jso','jsn'].includes(extension)&&conversionDirection!=='json-to-yaml'){
                        swapConversion();
                    }else if(['yaml','yml'].includes(extension)&&conversionDirection!=='yaml-to-json'){
                        swapConversion();
                    }
                    fileInfo.textContent=`Загружен файл: ${file.name} (${(file.size/1024).toFixed(2)} KB)`;
                    convertBtn.click();
                };
                reader.onerror=function(){alert('Ошибка при чтении файла');};
                reader.readAsText(file);
            }
            
            fileInput.addEventListener('change',function(e){
                const file=e.target.files[0];
                if(file){
                    const allowedExtensions=['json','jso','jsn','yaml','yml','txt'];
                    const extension=file.name.split('.').pop().toLowerCase();
                    if(allowedExtensions.includes(extension)){
                        handleFileUpload(file);
                    }else{
                        alert('Пожалуйста, выберите файл с расширением .json, .jso, .jsn, .yaml, .yml или .txt');
                        fileInput.value='';
                    }
                }
            });
            
            function detectInputType(text){
                const trimmed=text.trim();
                if(trimmed==='')return'empty';
                try{JSON.parse(trimmed);return'json';}
                catch(e){
                    if(trimmed.includes(':')||trimmed.includes('-')||trimmed.includes('---')){return'yaml';}
                    return'unknown';
                }
            }
            
            function jsonToYaml(jsonText){
                try{
                    const obj=JSON.parse(jsonText);
                    return jsyaml.dump(obj);
                }catch(error){throw new Error('Невалидный JSON: '+error.message);}
            }
            
            function yamlToJson(yamlText){
                try{
                    const obj=jsyaml.load(yamlText);
                    return JSON.stringify(obj,null,2);
                }catch(error){throw new Error('Ошибка парсинга YAML: '+error.message);}
            }
            
            function convert(){
                const input=inputText.value.trim();
                if(input===''){showMessage(errorMessage,'Введите данные для конвертации');return;}
                try{
                    let result;
                    if(conversionDirection==='json-to-yaml'){result=jsonToYaml(input);}
                    else{result=yamlToJson(input);}
                    outputText.value=result;
                    showMessage(successMessage,'Конвертация выполнена успешно!');
                }catch(error){showMessage(errorMessage,error.message);outputText.value='';}
            }
            
            function swapConversion(){
                if(conversionDirection==='json-to-yaml'){
                    conversionDirection='yaml-to-json';
                    inputBadge.textContent='YAML';
                    outputBadge.textContent='JSON';
                    inputBadge.className='language-badge yaml';
                    outputBadge.className='language-badge json';
                    convertBtn.innerHTML='<span>Конвертировать</span> <span>→</span>';
                }else{
                    conversionDirection='json-to-yaml';
                    inputBadge.textContent='JSON';
                    outputBadge.textContent='YAML';
                    inputBadge.className='language-badge json';
                    outputBadge.className='language-badge yaml';
                    convertBtn.innerHTML='<span>Конвертировать</span> <span>→</span>';
                }
                const temp=inputText.value;
                inputText.value=outputText.value;
                outputText.value=temp;
            }
            
            function loadExample(){
                const exampleJson=`{
  "app": "LostBox Tools",
  "version": "1.0.0",
  "author": {
    "name": "LostBox",
    "email": "hello@lostbox.com"
  },
  "features": [
    "JSON/YAML конвертер",
    "HTML форматирование",
    "Генератор звуков"
  ],
  "settings": {
    "theme": "dark",
    "autoSave": true
  }
}`;
                const exampleYaml=`app: LostBox Tools
version: 1.0.0
author:
  name: LostBox
  email: hello@lostbox.com
features:
  - JSON/YAML конвертер
  - HTML форматирование
  - Генератор звуков
settings:
  theme: dark
  autoSave: true`;
                if(conversionDirection==='json-to-yaml'){inputText.value=exampleJson;}
                else{inputText.value=exampleYaml;}
                showMessage(successMessage,'Пример данных загружен!');
            }
            
            convertBtn.addEventListener('click',convert);
            swapBtn.addEventListener('click',swapConversion);
            clearBtn.addEventListener('click',function(){inputText.value='';outputText.value='';fileInput.value='';fileInfo.textContent='';showMessage(successMessage,'Все поля очищены');});
            copyBtn.addEventListener('click',function(){if(outputText.value.trim()===''){showMessage(errorMessage,'Нет данных для копирования');return;}outputText.select();document.execCommand('copy');showMessage(successMessage,'Результат скопирован в буфер обмена!');});
            exampleBtn.addEventListener('click',loadExample);
            
            inputText.addEventListener('input',function(){
                const inputType=detectInputType(inputText.value);
                if(inputType==='json'&&conversionDirection==='yaml-to-json'){if(conversionDirection!=='json-to-yaml'){swapConversion();}}
                else if(inputType==='yaml'&&conversionDirection==='json-to-yaml'){if(conversionDirection!=='yaml-to-json'){swapConversion();}}
            });
            
            loadExample();
        });
    </script>
</body>
</html>
