<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <meta name="robots" content="noindex, nofollow">
    <title>test</title>
   <style>
   * {
     padding: 10px;
     box-sizing: border-box;
     webkit-tap-highlight-color: transparent;
   }
   input {
     width: 250px;
     padding: 10px;
     font-size: 1.2em;
     text-align: right;
   }
    .io {
      width: 50px;
      height: 50px;
      line-height: 30px;
      background-color: #008080;
      border: 5px solid;
      border-top-color: #00cccc;
      border-left-color: #00cccc;
      border-right-color: #005555;
      border-bottom-color: #005555;
      box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
      text-align: center;
      color: white;
      cursor: pointer;
      display: inline-block;
      margin: 5px;
      font-weight: bold;
    } 
    .io:active {
     border-top-color: #005555;
     border-left-color: #005555;
     border-right-color: #00cccc;
     border-bottom-color: #00cccc;
     transform: translate(1px, 1px);
     box-shadow: none;
    }
   </style>
  </head>
  <body>
    <div><input type="text" id="display" placeholder="Вводите числа" readonly></div> 
    <div id="buttons">
      <div><span class="io">1</span><span class="io">2</span><span class="io">3</span></div>
      <div><span class="io">4</span><span class="io">5</span><span class="io">6</span></div>
      <div><span class="io">7</span><span class="io">8</span><span class="io">9</span></div>
      <div><span class="io">•</span><span class="io">0</span><span class="io">#</span></div>
      <div><span class="io" style="width: 170px; background-color: #8B0000;">C</span></div> </div>

    <script>
    const display = document.getElementById('display');
    const buttons = document.getElementById('buttons');
    
   function simpleHash(str) {
        let hash = 0;
        if (str.length === 0) return "000";
        for (let i = 0; i < str.length; i++) {
            const char = str.charCodeAt(i);
            hash = ((hash << 5) - hash) + char;
            hash |= 0; // Преобразование в 32-битное целое число
        }
        // Преобразуем в положительное число и затем в HEX
        return (hash >>> 0).toString(16).padStart(8, '0'); 
    }

    // Хеш-функция 2: Более "случайный" хеш, типа FNV-1a (для примера)
    function complexHash(str) {
        let hash = 2166136261; // FNV-offset-basis
        for (let i = 0; i < str.length; i++) {
            hash ^= str.charCodeAt(i);
            hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);
            hash |= 0; // Преобразование в 32-битное целое число
        }
        // Преобразуем в положительное число и затем в HEX
        return (hash >>> 0).toString(16).padStart(8, '0');
    }


    // Добавляем обработчик кликов на кнопки
    buttons.addEventListener('click', (event) => {
        const buttonValue = event.target.textContent;
        
        // Проверяем, что клик был именно на кнопке .io
        if (!event.target.classList.contains('io')) {
            return;
        }

        const currentValue = display.value;

        // --- Логика ввода чисел и символов ---
        if (['1', '2', '3', '4', '5', '6', '7', '8', '9', '0', '#'].includes(buttonValue)) {
            // Защита от ввода # в начале или подряд
            if (buttonValue === '#') {
                // # можно добавить только после цифры и только один раз
                if (currentValue.length === 0 || currentValue.endsWith('#')) {
                    return;
                }
            }
            display.value += buttonValue;

        // --- Логика нажатия на "•" (РАСЧЕТ) ---
        } else if (buttonValue === '•') {
            
            // Проверка на пустой ввод
            if (currentValue.length === 0 || currentValue === '#') {
                display.value = "Ошибка: Введите числа";
                return;
            }

            let dataToHash = currentValue;
            let hashFunction = simpleHash; // Хеш по умолчанию
            
            // Проверяем, стоит ли # в конце для использования другого хеша
            if (currentValue.endsWith('#')) {
                // Удаляем # из данных для хеширования и меняем функцию
                dataToHash = currentValue.slice(0, -1);
                hashFunction = complexHash;
            }

            // Вычисляем хеш
            const hashResult = hashFunction(dataToHash);
            
            // Находим первые 3 цифры в HEX-хеше
            // Используем RegExp для поиска первой последовательности из 3 цифр
            const match = hashResult.match(/\d{3}/);
            
            let finalResult = "000"; // Результат по умолчанию

            if (match) {
                finalResult = match[0];
            } else {
                // Если в хеше (который HEX) нет 3 подряд цифр, берем первые 3 символа
                // Тут уже решать тебе, но по заданию надо "3 цифры"
                // Для простоты я беру первые 3 символа, если цифр нет
                finalResult = hashResult.substring(0, 3);
            }
            
            // Выводим результат и сбрасываем поле ввода, чтоб было видно результат
            display.value = finalResult;

        // --- Логика очистки (Кнопка C) ---
        } else if (buttonValue === 'C') {
            display.value = '';
        }
        
    });

    // Запрет ручного ввода (повторяем, так как readonly может быть обойден)
    display.addEventListener('keydown', (e) => {
        // Разрешаем только навигационные клавиши (Backspace, стрелки)
        if (!e.key.match(/^(Backspace|ArrowLeft|ArrowRight|Delete)$/)) {
            e.preventDefault();
        }
    });

    </script>
  </body>
</html>
