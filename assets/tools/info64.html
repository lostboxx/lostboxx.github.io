<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="–ò–Ω—Ñ–æ—Ä–º–∞—Ç–æ—Ä –æ—Ç LostBox: –ó–∞–≥—Ä—É–∑–∏—Ç–µ BASE-64 —Ñ–∞–π–ª, –∏ —É–∑–Ω–∞–π—Ç–µ: –≤–∞–ª–∏–¥–µ–Ω –ª–∏ –æ–Ω." />
<meta name="keywords" content="–∏–Ω—Ñ–æ—Ä–º–∞—Ç–æ—Ä, base-64, base64, –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å">
<!-- Favicon -->
<link rel="icon" type="image/png" sizes="256x256" href="https://lostbox1000.neocities.org/favicon.png" />
<title>–ò–Ω—Ñ–æ—Ä–º–∞—Ç–æ—Ä</title>
<style>
  body {
    background: #87CEEB;
    color: #000;
    font-family: sans-serif;
    margin: 0; padding: 10px;
    display: flex; flex-direction: column; align-items: center;
    min-height: 100vh; box-sizing: border-box;
  }
  h1 { margin: 10px 0 5px; font-size: 20px; text-align: center; }
  p.subtitle { font-size: 13px; margin: 0 0 6px; text-align: center; max-width: 90%; color: #222; }
  #uploader {
    position: relative; width: 80vw; max-width: 240px; height: 80vw; max-height: 240px;
    border: 2px dashed #555; background: #fff;
    display: flex; align-items: center; justify-content: center;
    border-radius: 12px; overflow: hidden;
    cursor: pointer; user-select: none; margin: 10px 0;
  }
  #uploader.placeholder::before {
    content: "+"; font-size: 48px; color: #555;
  }
  #uploader img, #uploader video, #uploader audio { 
    width: 100%; height: 100%; object-fit: contain; 
  }
  input[type="file"] { display: none; }
  #extension-input-container {
    display: none;
    margin: 10px 0;
    text-align: center;
  }
  #extension-input {
    padding: 5px;
    border: 1px solid #555;
    border-radius: 4px;
    margin-right: 5px;
  }
  #extension-submit {
    padding: 5px 10px;
    background: #0077cc;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }
  #status { font-size: 14px; margin-top: 5px; font-weight: bold; }
  #reset-btn {
    margin-top: 6px; font-size: 14px; color: #0077cc;
    cursor: pointer; user-select: none;
  }
</style>
</head>
<body>

  <h1>–ò–Ω—Ñ–æ—Ä–º–∞—Ç–æ—Ä</h1>
  <p class="subtitle">–ó–∞–≥—Ä—É–∑–∏—Ç–µ .txt —Å base64-—Å–æ–¥–µ—Ä–∂–∏–º—ã–º (—Ñ–æ—Ç–æ, –∞—É–¥–∏–æ, –≤–∏–¥–µ–æ)</p>
  <div id="uploader" class="placeholder" tabindex="0"></div>
  <input type="file" id="file-input" accept=".txt,application/json,image/*">
  
  <div id="extension-input-container">
    <p>–í–≤–µ–¥–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞:</p>
    <input type="text" id="extension-input" placeholder="jpg, png, mp3...">
    <button id="extension-submit">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
  </div>
  
  <div id="status"></div>
  <div id="reset-btn" style="display:none;">üîÑ –°–±—Ä–æ—Å</div>

  <script>
    const uploader = document.getElementById('uploader');
    const fileInput = document.getElementById('file-input');
    const statusDiv = document.getElementById('status');
    const resetBtn = document.getElementById('reset-btn');
    const extensionInputContainer = document.getElementById('extension-input-container');
    const extensionInput = document.getElementById('extension-input');
    const extensionSubmit = document.getElementById('extension-submit');

    let currentBase64Data = '';

    // –°–ª–æ–≤–∞—Ä—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
    const extensionTypes = {
      // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
      'jpg': 'image/jpeg',
      'jpeg': 'image/jpeg',
      'png': 'image/png',
      'gif': 'image/gif',
      'bmp': 'image/bmp',
      'webp': 'image/webp',
      'svg': 'image/svg+xml',
      'ico': 'image/x-icon',
      
      // –ê—É–¥–∏–æ
      'mp3': 'audio/mpeg',
      'wav': 'audio/wav',
      'ogg': 'audio/ogg',
      'aac': 'audio/aac',
      'flac': 'audio/flac',
      'm4a': 'audio/mp4',
      
      // –í–∏–¥–µ–æ
      'mp4': 'video/mp4',
      'avi': 'video/x-msvideo',
      'mov': 'video/quicktime',
      'webm': 'video/webm',
      'mkv': 'video/x-matroska',
      'flv': 'video/x-flv',
      'wmv': 'video/x-ms-wmv',
      'm4v': 'video/mp4',
      '3gp': 'video/3gpp'
    };

    uploader.addEventListener('click', () => {
      fileInput.click();
      statusDiv.textContent = '';
      resetBtn.style.display = 'none';
      extensionInputContainer.style.display = 'none';
    });

    fileInput.addEventListener('change', e => {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = () => {
        const text = reader.result.trim();
        processCheck(text);
      };
      reader.readAsText(file);
    });

    resetBtn.addEventListener('click', resetAll);
    
    extensionSubmit.addEventListener('click', () => {
      const extension = extensionInput.value.toLowerCase().trim();
      if (!extension) {
        statusDiv.textContent = '‚ùå –í–≤–µ–¥–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞';
        return;
      }
      
      processWithExtension(extension);
    });

    function processCheck(data) {
      currentBase64Data = data;
      
      // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —É–∂–µ —Å–æ–¥–µ—Ä–∂–∞—Ç data: URI —Å—Ö–µ–º—É (–ª—é–±–æ–≥–æ —Ç–∏–ø–∞)
      if (data.startsWith('data:')) {
        validateAndDisplay(data);
        return;
      }

      // –ü—Ä–æ–≤–µ—Ä–∏–º, –ø–æ—Ö–æ–∂–µ –ª–∏ —ç—Ç–æ –≤–æ–æ–±—â–µ –Ω–∞ base64
      const isMaybeB64 = /^[A-Za-z0-9+/=\s\r\n]+$/.test(data);
      if (isMaybeB64) {
        // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
        extensionInputContainer.style.display = 'block';
        statusDiv.textContent = '‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏';
      } else {
        statusDiv.textContent = '‚ùó –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π txt-—Ñ–∞–π–ª —Å Base64';
        resetBtn.style.display = 'block';
      }
    }

    function processWithExtension(extension) {
      const cleanB64 = currentBase64Data.replace(/\s+/g, '');
      
      // –ü–æ–ª—É—á–∞–µ–º MIME —Ç–∏–ø –∏–∑ —Å–ª–æ–≤–∞—Ä—è
      const mimeType = extensionTypes[extension];
      
      if (mimeType) {
        const fullDataURI = `data:${mimeType};base64,${cleanB64}`;
        validateAndDisplay(fullDataURI);
      } else {
        statusDiv.textContent = `‚ùå –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ: ${extension}`;
      }
    }

    function validateAndDisplay(dataURI) {
      // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –º–µ–¥–∏–∞
      const mediaType = dataURI.split(':')[1].split(';')[0].split('/')[0];
      
      switch(mediaType) {
        case 'image':
          displayImage(dataURI);
          break;
        case 'audio':
          displayAudio(dataURI);
          break;
        case 'video':
          displayVideo(dataURI);
          break;
        default:
          statusDiv.textContent = '‚ùå –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø –º–µ–¥–∏–∞';
          resetBtn.style.display = 'block';
      }
    }

    function displayImage(src) {
      const img = new Image();
      img.onload = () => {
        uploader.innerHTML = ''; 
        uploader.classList.remove('placeholder');
        uploader.appendChild(img);
        statusDiv.textContent = '‚úîÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∞–ª–∏–¥–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π –Ω–∞—à ¬´–ë—ã—Å—Ç—Ä—ã–π BASE-64¬ª —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å base64 —Ñ–∞–π–ª, –∏–ª–∏ ¬´–ú–∞—Å—Å–æ–≤—ã–π BASE-64¬ª —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤!';
        resetBtn.style.display = 'block';
        extensionInputContainer.style.display = 'none';
      };
      img.onerror = () => {
        statusDiv.textContent = '‚ùå –ü–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–π Base64 (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)';
        resetBtn.style.display = 'block';
        extensionInputContainer.style.display = 'none';
      };
      img.src = src;
    }

    function displayAudio(src) {
      const audio = document.createElement('audio');
      audio.controls = true;
      
      audio.onloadeddata = () => {
        uploader.innerHTML = ''; 
        uploader.classList.remove('placeholder');
        uploader.appendChild(audio);
        statusDiv.textContent = '‚úîÔ∏è –ê—É–¥–∏–æ –≤–∞–ª–∏–¥–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π –Ω–∞—à ¬´–ë—ã—Å—Ç—Ä—ã–π BASE-64¬ª —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å base64 —Ñ–∞–π–ª, –∏–ª–∏ ¬´–ú–∞—Å—Å–æ–≤—ã–π BASE-64¬ª —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤!';
        resetBtn.style.display = 'block';
        extensionInputContainer.style.display = 'none';
      };
      
      audio.onerror = () => {
        statusDiv.textContent = '‚ùå –ü–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–π Base64 (–∞—É–¥–∏–æ)';
        resetBtn.style.display = 'block';
        extensionInputContainer.style.display = 'none';
      };
      
      audio.src = src;
    }

    function displayVideo(src) {
      const video = document.createElement('video');
      video.controls = true;
      
      video.onloadeddata = () => {
        uploader.innerHTML = ''; 
        uploader.classList.remove('placeholder');
        uploader.appendChild(video);
        statusDiv.textContent = '‚úîÔ∏è –í–∏–¥–µ–æ –≤–∞–ª–∏–¥–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π –Ω–∞—à ¬´–ë—ã—Å—Ç—Ä—ã–π BASE-64¬ª —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å base64 —Ñ–∞–π–ª, –∏–ª–∏ ¬´–ú–∞—Å—Å–æ–≤—ã–π BASE-64¬ª —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤!';
        resetBtn.style.display = 'block';
        extensionInputContainer.style.display = 'none';
      };
      
      video.onerror = () => {
        statusDiv.textContent = '‚ùå –ü–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã–π Base64 (–≤–∏–¥–µ–æ)';
        resetBtn.style.display = 'block';
        extensionInputContainer.style.display = 'none';
      };
      
      video.src = src;
    }

    function resetAll() {
      uploader.innerHTML = '';
      uploader.classList.add('placeholder');
      statusDiv.textContent = '';
      resetBtn.style.display = 'none';
      extensionInputContainer.style.display = 'none';
      extensionInput.value = '';
      currentBase64Data = '';
      fileInput.value = '';
    }
  </script>

</body>
</html>