<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="robots" content="noindex, follow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 20px;
            max-width: 400px;
            width: 100%;
        }
        
        header {
            text-align: center;
            margin-bottom: 15px;
        }
        
        h1 {
            font-size: 24px;
            color: #333;
            margin-bottom: 10px;
        }
        
        .difficulty-control {
            margin: 10px 0;
        }
        
        #difficultyBtn {
            background: #e0e0e0;
            border: 1px solid #ccc;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        #difficultyBtn:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            background: #f0f0f0;
            border-radius: 4px;
            padding: 10px;
            margin: 15px 0;
        }
        
        .stat-item {
            text-align: center;
            font-size: 14px;
        }
        
        .stat-value {
            font-weight: bold;
            font-size: 18px;
        }
        
        .board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-gap: 5px;
            margin: 0 auto;
            background: #ddd;
            padding: 5px;
            border-radius: 4px;
        }
        
        .cell {
            background-color: #eee;
            border-radius: 4px;
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .cell.filled {
            background-color: #ddd;
            cursor: default;
        }
        
        .cell.x {
            color: #e74c3c;
        }
        
        .cell.o {
            color: #3498db;
        }
        
        .cell.winning {
            background-color: #c0ffc0;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            margin-top: 15px;
            gap: 10px;
        }
        
        #newGameBtn {
            background: #2ecc71;
            color: white;
            border: none;
            padding: 8px 20px;
            font-size: 14px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        #clearStatsBtn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            font-size: 12px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
        }
        
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            max-width: 300px;
            width: 90%;
        }
        
        .result-emoji {
            font-size: 40px;
            margin-bottom: 10px;
        }
        
        .result-text {
            font-size: 20px;
            margin-bottom: 15px;
            color: #333;
        }
        
        .modal button {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 20px;
            font-size: 14px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        footer {
            text-align: center;
            margin-top: 15px;
            color: #777;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</h1>
            <div class="difficulty-control">
                <button id="difficultyBtn">–°–ª–æ–∂–Ω–æ—Å—Ç—å: –õ–µ–≥–∫–∏–π</button>
            </div>
        </header>
        
        <div class="stats">
            <div class="stat-item">
                <div>–ü–æ–±–µ–¥—ã</div>
                <div id="wins" class="stat-value">0</div>
            </div>
            <div class="stat-item">
                <div>–ü–æ—Ä–∞–∂–µ–Ω–∏—è</div>
                <div id="losses" class="stat-value">0</div>
            </div>
            <div class="stat-item">
                <div>–ù–∏—á—å–∏</div>
                <div id="draws" class="stat-value">0</div>
            </div>
        </div>
        
        <div class="board" id="board">
            <div class="cell" data-index="0"></div>
            <div class="cell" data-index="1"></div>
            <div class="cell" data-index="2"></div>
            <div class="cell" data-index="3"></div>
            <div class="cell" data-index="4"></div>
            <div class="cell" data-index="5"></div>
            <div class="cell" data-index="6"></div>
            <div class="cell" data-index="7"></div>
            <div class="cell" data-index="8"></div>
        </div>
        
        <div class="controls">
            <button id="newGameBtn">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            <button id="clearStatsBtn">–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
        </div>
        
        <footer>
            <span id="playerInfo">–ò–≥—Ä–æ–∫: <strong>X</strong> | –ë–æ—Ç: <strong>O</strong></span>
        </footer>
    </div>
    
    <div class="modal" id="resultModal">
        <div class="modal-content">
            <div class="result-emoji" id="resultEmoji">üòé</div>
            <div class="result-text" id="resultText">–í—ã –ø–æ–±–µ–¥–∏–ª–∏!</div>
            <button id="closeModal">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
        </div>
    </div>

    <script>
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        const gameState = {
            board: Array(9).fill(''),
            currentPlayer: 'X',
            gameActive: true,
            difficulty: 'easy', // easy, medium, hard, twoPlayers
            movesCount: 0,
            wins: 0,
            losses: 0,
            draws: 0
        };

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const boardElement = document.getElementById('board');
        const cells = document.querySelectorAll('.cell');
        const difficultyBtn = document.getElementById('difficultyBtn');
        const newGameBtn = document.getElementById('newGameBtn');
        const clearStatsBtn = document.getElementById('clearStatsBtn');
        const resultModal = document.getElementById('resultModal');
        const resultEmoji = document.getElementById('resultEmoji');
        const resultText = document.getElementById('resultText');
        const closeModal = document.getElementById('closeModal');
        const winsElement = document.getElementById('wins');
        const lossesElement = document.getElementById('losses');
        const drawsElement = document.getElementById('draws');
        const playerInfo = document.getElementById('playerInfo');

        // –ú–µ–Ω–µ–¥–∂–µ—Ä IndexedDB
        const DBManager = {
            dbName: 'TicTacToeDB',
            dbVersion: 1,
            storeName: 'stats',
            
            // –û—Ç–∫—Ä—ã—Ç–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            openDB: function() {
                return new Promise((resolve, reject) => {
                    if (!window.indexedDB) {
                        reject(new Error('IndexedDB –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è'));
                        return;
                    }

                    const request = indexedDB.open(this.dbName, this.dbVersion);
                    
                    request.onerror = () => reject(request.error);
                    request.onsuccess = () => resolve(request.result);
                    
                    request.onupgradeneeded = (event) => {
                        const db = event.target.result;
                        
                        // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
                        if (db.objectStoreNames.contains(this.storeName)) {
                            db.deleteObjectStore(this.storeName);
                        }
                        
                        // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
                        const store = db.createObjectStore(this.storeName, { keyPath: 'id' });
                        console.log('–•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ–∑–¥–∞–Ω–æ:', this.storeName);
                    };
                });
            },
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            saveStats: async function() {
                try {
                    const db = await this.openDB();
                    const transaction = db.transaction([this.storeName], 'readwrite');
                    const store = transaction.objectStore(this.storeName);
                    
                    const statsData = {
                        id: 'currentStats',
                        wins: gameState.wins,
                        losses: gameState.losses,
                        draws: gameState.draws,
                        lastUpdated: new Date().toISOString()
                    };
                    
                    return new Promise((resolve, reject) => {
                        const request = store.put(statsData);
                        request.onsuccess = () => {
                            db.close();
                            resolve();
                            console.log('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞:', statsData);
                        };
                        request.onerror = () => {
                            db.close();
                            reject(request.error);
                        };
                    });
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
                }
            },
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            loadStats: async function() {
                try {
                    const db = await this.openDB();
                    const transaction = db.transaction([this.storeName], 'readonly');
                    const store = transaction.objectStore(this.storeName);
                    
                    return new Promise((resolve, reject) => {
                        const request = store.get('currentStats');
                        
                        request.onsuccess = () => {
                            db.close();
                            const stats = request.result;
                            if (stats) {
                                gameState.wins = stats.wins || 0;
                                gameState.losses = stats.losses || 0;
                                gameState.draws = stats.draws || 0;
                                console.log('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞:', stats);
                            }
                            resolve();
                        };
                        
                        request.onerror = () => {
                            db.close();
                            reject(request.error);
                        };
                    });
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ –æ—à–∏–±–∫–µ
                    gameState.wins = 0;
                    gameState.losses = 0;
                    gameState.draws = 0;
                }
            },
            
            // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            clearStats: async function() {
                try {
                    const db = await this.openDB();
                    const transaction = db.transaction([this.storeName], 'readwrite');
                    const store = transaction.objectStore(this.storeName);
                    
                    return new Promise((resolve, reject) => {
                        const request = store.delete('currentStats');
                        
                        request.onsuccess = () => {
                            db.close();
                            gameState.wins = 0;
                            gameState.losses = 0;
                            gameState.draws = 0;
                            updateStatsDisplay();
                            console.log('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—á–∏—â–µ–Ω–∞');
                            resolve();
                        };
                        
                        request.onerror = () => {
                            db.close();
                            reject(request.error);
                        };
                    });
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
                }
            }
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
            gameState.board = Array(9).fill('');
            gameState.currentPlayer = 'X';
            gameState.gameActive = true;
            gameState.movesCount = 0;
            
            // –û—á–∏—Å—Ç–∫–∞ –¥–æ—Å–∫–∏
            cells.forEach(cell => {
                cell.textContent = '';
                cell.classList.remove('x', 'o', 'winning', 'filled');
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            updateStatsDisplay();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∏–≥—Ä–æ–∫–∞—Ö
            updatePlayerInfo();
            
            // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –Ω–æ–≤–æ–π –∏–≥—Ä–µ
            difficultyBtn.disabled = false;
            updateDifficultyButton();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        function updateDifficultyButton() {
            const difficultyNames = {
                easy: '–õ–µ–≥–∫–∏–π',
                medium: '–°—Ä–µ–¥–Ω–∏–π',
                hard: '–¢—è–∂–µ–ª—ã–π',
                twoPlayers: '–î–≤–∞ –∏–≥—Ä–æ–∫–∞'
            };
            
            difficultyBtn.textContent = `–°–ª–æ–∂–Ω–æ—Å—Ç—å: ${difficultyNames[gameState.difficulty]}`;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∏–≥—Ä–æ–∫–∞—Ö –≤ —Ñ—É—Ç–µ—Ä–µ
        function updatePlayerInfo() {
            if (gameState.difficulty === 'twoPlayers') {
                playerInfo.innerHTML = '–ò–≥—Ä–æ–∫ 1: <strong>X</strong> | –ò–≥—Ä–æ–∫ 2: <strong>O</strong>';
            } else {
                playerInfo.innerHTML = '–ò–≥—Ä–æ–∫: <strong>X</strong> | –ë–æ—Ç: <strong>O</strong>';
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStatsDisplay() {
            winsElement.textContent = gameState.wins;
            lossesElement.textContent = gameState.losses;
            drawsElement.textContent = gameState.draws;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
        function checkWin() {
            const winPatterns = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8], // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ
                [0, 3, 6], [1, 4, 7], [2, 5, 8], // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ
                [0, 4, 8], [2, 4, 6]             // –î–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–µ
            ];

            for (const pattern of winPatterns) {
                const [a, b, c] = pattern;
                if (gameState.board[a] && 
                    gameState.board[a] === gameState.board[b] && 
                    gameState.board[a] === gameState.board[c]) {
                    
                    // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø–æ–±–µ–¥–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫
                    cells[a].classList.add('winning');
                    cells[b].classList.add('winning');
                    cells[c].classList.add('winning');
                    
                    return gameState.board[a];
                }
            }
            
            return null;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏—á—å–µ–π
        function checkDraw() {
            return gameState.movesCount === 9 && !checkWin();
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏–≥—Ä—ã
        function handleGameResult(winner) {
            gameState.gameActive = false;
            
            if (gameState.difficulty === 'twoPlayers') {
                // –†–µ–∂–∏–º –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤
                if (winner === 'X') {
                    // –ü–æ–±–µ–¥–∞ –∏–≥—Ä–æ–∫–∞ 1
                    gameState.wins++;
                    showResultModal('üòé', '–ò–≥—Ä–æ–∫ 1 –ø–æ–±–µ–¥–∏–ª!');
                } else if (winner === 'O') {
                    // –ü–æ–±–µ–¥–∞ –∏–≥—Ä–æ–∫–∞ 2
                    gameState.losses++;
                    showResultModal('üòµ', '–ò–≥—Ä–æ–∫ 2 –ø–æ–±–µ–¥–∏–ª!');
                } else {
                    // –ù–∏—á—å—è
                    gameState.draws++;
                    showResultModal('üòê', '–ù–∏—á—å—è!');
                }
            } else {
                // –†–µ–∂–∏–º –ø—Ä–æ—Ç–∏–≤ –±–æ—Ç–∞
                if (winner === 'X') {
                    // –ü–æ–±–µ–¥–∞ –∏–≥—Ä–æ–∫–∞
                    gameState.wins++;
                    showResultModal('üòé', '–í—ã –ø–æ–±–µ–¥–∏–ª–∏!');
                } else if (winner === 'O') {
                    // –ü–æ–±–µ–¥–∞ –±–æ—Ç–∞
                    gameState.losses++;
                    showResultModal('üòµ', '–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏!');
                } else {
                    // –ù–∏—á—å—è
                    gameState.draws++;
                    showResultModal('üòê', '–ù–∏—á—å—è!');
                }
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            DBManager.saveStats();
            updateStatsDisplay();
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
        function showResultModal(emoji, text) {
            resultEmoji.textContent = emoji;
            resultText.textContent = text;
            resultModal.classList.add('active');
        }

        // –•–æ–¥ –∏–≥—Ä–æ–∫–∞
        function playerMove(index) {
            if (!gameState.gameActive || gameState.board[index] !== '') {
                return;
            }
            
            // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ö–æ–¥–∞
            gameState.board[index] = gameState.currentPlayer;
            cells[index].textContent = gameState.currentPlayer;
            cells[index].classList.add(gameState.currentPlayer === 'X' ? 'x' : 'o', 'filled');
            gameState.movesCount++;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ—Å–ª–µ —Ö–æ–¥–∞
            const winner = checkWin();
            if (winner) {
                handleGameResult(winner);
                return;
            } else if (checkDraw()) {
                handleGameResult(null);
                return;
            }
            
            // –ü–µ—Ä–µ—Ö–æ–¥ —Ö–æ–¥–∞
            gameState.currentPlayer = gameState.currentPlayer === 'X' ? 'O' : 'X';
            
            // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–∫–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Ö–æ–¥–∞ –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–æ—Ç–∏–≤ –±–æ—Ç–∞
            if (gameState.movesCount === 1 && gameState.difficulty !== 'twoPlayers') {
                difficultyBtn.disabled = true;
            }
            
            // –•–æ–¥ –±–æ—Ç–∞, –µ—Å–ª–∏ –Ω–µ —Ä–µ–∂–∏–º –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤
            if (gameState.difficulty !== 'twoPlayers' && gameState.currentPlayer === 'O') {
                // –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ —Ö–æ–¥–æ–º –±–æ—Ç–∞
                setTimeout(botMove, 600 + Math.random() * 400);
            }
        }

        // –•–æ–¥ –±–æ—Ç–∞
        function botMove() {
            if (!gameState.gameActive || gameState.currentPlayer !== 'O') {
                return;
            }
            
            let moveIndex;
            
            // –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            switch (gameState.difficulty) {
                case 'easy':
                    moveIndex = getRandomMove();
                    break;
                case 'medium':
                    moveIndex = getMediumMove();
                    break;
                case 'hard':
                    moveIndex = getHardMove();
                    break;
            }
            
            // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ö–æ–¥–∞
            gameState.board[moveIndex] = 'O';
            cells[moveIndex].textContent = 'O';
            cells[moveIndex].classList.add('o', 'filled');
            gameState.movesCount++;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ—Å–ª–µ —Ö–æ–¥–∞ –±–æ—Ç–∞
            const winner = checkWin();
            if (winner) {
                handleGameResult(winner);
                return;
            } else if (checkDraw()) {
                handleGameResult(null);
                return;
            }
            
            // –ü–µ—Ä–µ—Ö–æ–¥ —Ö–æ–¥–∞ –∫ –∏–≥—Ä–æ–∫—É
            gameState.currentPlayer = 'X';
        }

        // –°–ª—É—á–∞–π–Ω—ã–π —Ö–æ–¥ (–ª–µ–≥–∫–∏–π —É—Ä–æ–≤–µ–Ω—å)
        function getRandomMove() {
            const emptyCells = [];
            gameState.board.forEach((cell, index) => {
                if (cell === '') emptyCells.push(index);
            });
            
            return emptyCells[Math.floor(Math.random() * emptyCells.length)];
        }

        // –•–æ–¥ —Å—Ä–µ–¥–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        function getMediumMove() {
            // 1. –ü–æ–ø—ã—Ç–∫–∞ –≤—ã–∏–≥—Ä–∞—Ç—å
            for (let i = 0; i < 9; i++) {
                if (gameState.board[i] === '') {
                    gameState.board[i] = 'O';
                    if (checkWin() === 'O') {
                        gameState.board[i] = '';
                        return i;
                    }
                    gameState.board[i] = '';
                }
            }
            
            // 2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–≥—Ä–æ–∫–∞
            for (let i = 0; i < 9; i++) {
                if (gameState.board[i] === '') {
                    gameState.board[i] = 'X';
                    if (checkWin() === 'X') {
                        gameState.board[i] = '';
                        return i;
                    }
                    gameState.board[i] = '';
                }
            }
            
            // 3. –ó–∞–Ω—è—Ç—å —Ü–µ–Ω—Ç—Ä, –µ—Å–ª–∏ —Å–≤–æ–±–æ–¥–µ–Ω
            if (gameState.board[4] === '') {
                return 4;
            }
            
            // 4. –°–ª—É—á–∞–π–Ω—ã–π —Ö–æ–¥
            return getRandomMove();
        }

        // –•–æ–¥ –≤—ã—Å–æ–∫–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        function getHardMove() {
            // 1. –ü–æ–ø—ã—Ç–∫–∞ –≤—ã–∏–≥—Ä–∞—Ç—å
            for (let i = 0; i < 9; i++) {
                if (gameState.board[i] === '') {
                    gameState.board[i] = 'O';
                    if (checkWin() === 'O') {
                        gameState.board[i] = '';
                        return i;
                    }
                    gameState.board[i] = '';
                }
            }
            
            // 2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∏–≥—Ä–æ–∫–∞
            for (let i = 0; i < 9; i++) {
                if (gameState.board[i] === '') {
                    gameState.board[i] = 'X';
                    if (checkWin() === 'X') {
                        gameState.board[i] = '';
                        return i;
                    }
                    gameState.board[i] = '';
                }
            }
            
            // 3. –ó–∞–Ω—è—Ç—å —Ü–µ–Ω—Ç—Ä, –µ—Å–ª–∏ —Å–≤–æ–±–æ–¥–µ–Ω
            if (gameState.board[4] === '') {
                return 4;
            }
            
            // 4. –ó–∞–Ω—è—Ç—å —É–≥–ª—ã
            const corners = [0, 2, 6, 8];
            const emptyCorners = corners.filter(index => gameState.board[index] === '');
            if (emptyCorners.length > 0) {
                return emptyCorners[Math.floor(Math.random() * emptyCorners.length)];
            }
            
            // 5. –°–ª—É—á–∞–π–Ω—ã–π —Ö–æ–¥
            return getRandomMove();
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        cells.forEach(cell => {
            cell.addEventListener('click', () => {
                const index = parseInt(cell.getAttribute('data-index'));
                playerMove(index);
            });
        });

        newGameBtn.addEventListener('click', initGame);

        clearStatsBtn.addEventListener('click', () => {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É?')) {
                DBManager.clearStats();
            }
        });

        closeModal.addEventListener('click', () => {
            resultModal.classList.remove('active');
            initGame();
        });

        difficultyBtn.addEventListener('click', () => {
            const difficulties = ['easy', 'medium', 'hard', 'twoPlayers'];
            const currentIndex = difficulties.indexOf(gameState.difficulty);
            gameState.difficulty = difficulties[(currentIndex + 1) % difficulties.length];
            updateDifficultyButton();
            updatePlayerInfo();
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', async () => {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–µ—Ä–µ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏–≥—Ä—ã
            await DBManager.loadStats();
            updateStatsDisplay();
            initGame();
        });
    </script>
</body>
</html>